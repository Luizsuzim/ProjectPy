{% extends "base.html" %}

{% block title %}Clientes{% endblock %}

{% block content %}
<div class="container">
    <h1>Clientes</h1>

    <form id="formCliente">
        <input type="text" id="nome" placeholder="Nome" required>
        <input type="text" id="telefone" placeholder="Telefone" required>
        <button type="submit">Cadastrar</button>
    </form>

    <ul id="listaClientes"></ul>
</div>

<script>
async function carregarClientes() {
    const resposta = await fetch("/api/clientes");
    const clientes = await resposta.json();

    const lista = document.getElementById("listaClientes");
    lista.innerHTML = "";

    clientes.forEach(cliente => {
        const li = document.createElement("li");
        li.textContent = `${cliente.nome} - ${cliente.telefone}`;
        lista.appendChild(li);
    });
}

document.getElementById("formCliente").addEventListener("submit", async (e) => {
    e.preventDefault();

    const nome = document.getElementById("nome").value;
    const telefone = document.getElementById("telefone").value;

    await fetch("/api/clientes", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ nome, telefone })
    });

    e.target.reset();
    carregarClientes();
});

carregarClientes();
</script>
{% endblock %}
